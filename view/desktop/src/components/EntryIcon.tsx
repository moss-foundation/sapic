import { Icon } from "@/lib/ui/Icon";
import { cn } from "@/utils";
import { StreamEntriesEvent } from "@repo/moss-collection";

import { TreeCollectionNode } from "./CollectionTree/types";

interface EntryIconProps {
  entry: TreeCollectionNode | StreamEntriesEvent;
  className?: string;
}

const defaultProtocolClassName = "text-xs right-0 uppercase absolute top-1/2 -translate-y-1/2   " as const;

export const EntryIcon = ({ entry, className }: EntryIconProps) => {
  const isRoot = entry.path.segments.length === 1;

  if (isRoot) {
    switch (entry.class) {
      case "Schema":
        return <Icon icon="SchemasFolder" className={className} />;
      case "Endpoint":
        return <Icon icon="EndpointsFolder" className={className} />;
      case "Component":
        return <Icon icon="ComponentsFolder" className={className} />;
      default:
        return <Icon icon="RequestsFolder" className={className} />;
    }
  }

  if (entry.kind === "Dir") {
    return <Icon icon="Folder" className={className} />;
  }

  switch (entry.protocol) {
    case "Get":
      return <GetIcon className={cn("shrink-0 pb-[1px]", className)} />;
    case "Post":
      return <PostIcon className={cn("shrink-0 pb-[1px]", className)} />;
    case "Put":
      return <PutIcon className={cn("shrink-0 pb-[1px]", className)} />;
    case "Delete":
      return <DeleteIcon className={cn("shrink-0 pb-[1px]", className)} />;

    default:
      return (
        <div className="relative size-4">
          <span className={cn(defaultProtocolClassName, "text-(--moss-gray-4)", className)}>{entry.protocol}</span>
        </div>
      );
  }
};

const GetIcon = ({ className }: { className?: string }) => {
  return (
    <svg
      width="24"
      height="16"
      viewBox="0 0 24 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={cn(`text-[#5FAD65] dark:text-[#208A3C]`, className)}
    >
      <path
        d="M9.42491 13C8.79585 13 8.31777 12.7706 7.99066 12.3118C7.66355 11.8531 7.5 11.1559 7.5 10.2204V6.90105C7.5 5.95652 7.69291 5.23688 8.07873 4.74213C8.47294 4.24738 9.03909 4 9.77718 4C10.532 4 11.1024 4.25637 11.4882 4.76912C11.874 5.28186 12.0376 5.97901 11.9789 6.86057C11.9705 6.95952 11.9327 7.009 11.8656 7.009L10.7711 6.9955C10.6956 6.9955 10.662 6.95052 10.6704 6.86057C10.7124 6.36582 10.6579 5.98351 10.5069 5.71364C10.3559 5.43478 10.1169 5.29535 9.78976 5.29535C9.45426 5.29535 9.20683 5.42579 9.04747 5.68666C8.88811 5.94753 8.80843 6.35682 8.80843 6.91454V10.1124C8.80843 10.6882 8.87553 11.0975 9.00973 11.3403C9.15232 11.5832 9.39555 11.7046 9.73943 11.7046C10.0582 11.7046 10.3014 11.5697 10.4691 11.2998C10.6369 11.021 10.7208 10.6027 10.7208 10.045V9.43778H9.85266C9.77718 9.43778 9.73943 9.38831 9.73943 9.28935V8.49325C9.73943 8.3943 9.77718 8.34483 9.85266 8.34483H11.8908C11.9663 8.34483 12.004 8.3943 12.004 8.49325V10.9625C12.004 11.3943 12.0082 11.7496 12.0166 12.0285C12.0334 12.2984 12.0544 12.5412 12.0795 12.7571C12.0963 12.8651 12.0627 12.919 11.9789 12.919H11.1234C11.0479 12.919 11.0059 12.8786 10.9975 12.7976C10.9808 12.6897 10.964 12.5637 10.9472 12.4198C10.9388 12.2669 10.9346 12.0825 10.9346 11.8666H10.9095C10.7837 12.2174 10.6033 12.4963 10.3685 12.7031C10.1336 12.901 9.81911 13 9.42491 13Z"
        fill="currentColor"
      />
      <path
        d="M13.243 12.919C13.1591 12.919 13.1172 12.8696 13.1172 12.7706V4.22938C13.1172 4.13043 13.1549 4.08096 13.2304 4.08096H16.577C16.6524 4.08096 16.6902 4.13043 16.6902 4.22938V5.21439C16.6902 5.31334 16.6524 5.36282 16.577 5.36282H14.4382V7.81859H16.3882C16.4637 7.81859 16.5015 7.86807 16.5015 7.96702V8.89805C16.5015 8.997 16.4637 9.04648 16.3882 9.04648H14.4382V11.6372H16.577C16.6524 11.6372 16.6902 11.6867 16.6902 11.7856V12.7706C16.6902 12.8696 16.6524 12.919 16.577 12.919H13.243Z"
        fill="currentColor"
      />
      <path
        d="M18.8706 12.919C18.7951 12.919 18.7573 12.8696 18.7573 12.7706V5.36282H17.4489C17.365 5.36282 17.3231 5.31334 17.3231 5.21439V4.22938C17.3231 4.13043 17.365 4.08096 17.4489 4.08096H21.3868C21.4623 4.08096 21.5 4.13043 21.5 4.22938V5.21439C21.5 5.31334 21.4623 5.36282 21.3868 5.36282H20.0783V12.7706C20.0783 12.8696 20.0364 12.919 19.9525 12.919H18.8706Z"
        fill="currentColor"
      />
    </svg>
  );
};

const PostIcon = ({ className }: { className?: string }) => {
  return (
    <svg
      width="24"
      height="16"
      viewBox="0 0 24 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={cn(`text-[#E56D17] dark:text-[#E08855]`, className)}
    >
      <path
        d="M2.61533 12.919C2.53844 12.919 2.5 12.8696 2.5 12.7706V4.22938C2.5 4.13043 2.53844 4.08096 2.61533 4.08096H4.1915C4.99453 4.08096 5.58399 4.31034 5.95988 4.76912C6.34431 5.22789 6.53653 5.94753 6.53653 6.92804C6.53653 7.83658 6.34004 8.53373 5.94706 9.01949C5.56263 9.50525 4.99453 9.74813 4.24275 9.74813H3.84551V12.7706C3.84551 12.8696 3.80707 12.919 3.73018 12.919H2.61533ZM3.84551 8.46627H4.1915C4.54176 8.46627 4.79377 8.34033 4.94754 8.08846C5.10986 7.83658 5.19102 7.45427 5.19102 6.94153C5.19102 6.37481 5.10986 5.97001 4.94754 5.72714C4.79377 5.48426 4.5503 5.36282 4.21713 5.36282H3.84551V8.46627Z"
        fill="currentColor"
      />
      <path
        d="M9.59766 13C8.83734 13 8.25642 12.7661 7.8549 12.2984C7.46193 11.8306 7.26544 11.1334 7.26544 10.2069V6.8066C7.26544 5.87106 7.46193 5.16941 7.8549 4.70165C8.25642 4.23388 8.83734 4 9.59766 4C10.3494 4 10.9261 4.23388 11.3276 4.70165C11.7291 5.16941 11.9299 5.87106 11.9299 6.8066V10.2069C11.9299 11.1334 11.7291 11.8306 11.3276 12.2984C10.9261 12.7661 10.3494 13 9.59766 13ZM9.59766 11.7046C9.93083 11.7046 10.1786 11.5832 10.3409 11.3403C10.5117 11.0975 10.5972 10.6972 10.5972 10.1394V6.87406C10.5972 6.30735 10.5117 5.90255 10.3409 5.65967C10.1786 5.41679 9.93083 5.29535 9.59766 5.29535C9.26448 5.29535 9.01247 5.41679 8.84161 5.65967C8.67929 5.90255 8.59814 6.30735 8.59814 6.87406V10.1394C8.59814 10.6972 8.67929 11.0975 8.84161 11.3403C9.01247 11.5832 9.26448 11.7046 9.59766 11.7046Z"
        fill="currentColor"
      />
      <path
        d="M14.6804 13C14.1678 13 13.7534 12.8921 13.4374 12.6762C13.1298 12.4603 12.912 12.1589 12.7838 11.7721C12.6642 11.3853 12.6258 10.931 12.6685 10.4093C12.677 10.3013 12.7155 10.2474 12.7838 10.2474H13.873C13.9499 10.2474 13.9841 10.2969 13.9756 10.3958C13.9329 10.8366 13.9756 11.1739 14.1037 11.4078C14.2319 11.6327 14.4369 11.7451 14.7188 11.7451C14.9751 11.7451 15.163 11.6642 15.2826 11.5022C15.4108 11.3403 15.4748 11.084 15.4748 10.7331C15.4748 10.4273 15.4279 10.1709 15.3339 9.96402C15.2485 9.74813 15.1032 9.55922 14.8982 9.3973L13.8218 8.50675C13.4374 8.1919 13.1512 7.85457 12.9632 7.49475C12.7753 7.12594 12.6856 6.67166 12.6941 6.13193C12.7027 5.45727 12.8735 4.93553 13.2067 4.56672C13.5399 4.18891 14.0268 4 14.6675 4C15.4022 4 15.9404 4.22039 16.2822 4.66117C16.6239 5.10195 16.7606 5.71814 16.6922 6.50974C16.6837 6.63568 16.6452 6.69865 16.5769 6.69865H15.4748C15.3894 6.69865 15.3552 6.63568 15.3723 6.50974C15.4065 6.13193 15.3681 5.83058 15.257 5.6057C15.1459 5.37181 14.9665 5.25487 14.7188 5.25487C14.5052 5.25487 14.3386 5.32684 14.219 5.47076C14.0994 5.61469 14.0354 5.83958 14.0268 6.14543C14.0268 6.44228 14.0781 6.68966 14.1806 6.88756C14.2917 7.08546 14.4497 7.26537 14.6547 7.42729L15.6927 8.27736C15.9746 8.49325 16.1967 8.71814 16.359 8.95202C16.5214 9.17691 16.6367 9.43328 16.705 9.72114C16.7819 10 16.8161 10.3328 16.8075 10.7196C16.8075 11.4393 16.6367 12.0015 16.295 12.4063C15.9532 12.8021 15.415 13 14.6804 13Z"
        fill="currentColor"
      />
      <path
        d="M18.8218 12.919C18.7449 12.919 18.7065 12.8696 18.7065 12.7706V5.36282H17.3738C17.2883 5.36282 17.2456 5.31334 17.2456 5.21439V4.22938C17.2456 4.13043 17.2883 4.08096 17.3738 4.08096H21.3847C21.4616 4.08096 21.5 4.13043 21.5 4.22938V5.21439C21.5 5.31334 21.4616 5.36282 21.3847 5.36282H20.052V12.7706C20.052 12.8696 20.0093 12.919 19.9238 12.919H18.8218Z"
        fill="currentColor"
      />
    </svg>
  );
};

const PutIcon = ({ className }: { className?: string }) => {
  return (
    <svg
      width="24"
      height="16"
      viewBox="0 0 24 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={cn(`text-[#3574F0] dark:text-[#548AF7]`, className)}
    >
      <path
        d="M7.61266 12.9183C7.53755 12.9183 7.5 12.8684 7.5 12.7685V4.14977C7.5 4.04992 7.53755 4 7.61266 4H9.15228C9.9367 4 10.5125 4.23147 10.8797 4.6944C11.2552 5.15734 11.4429 5.88351 11.4429 6.87292C11.4429 7.78971 11.251 8.49319 10.8672 8.98336C10.4916 9.47353 9.9367 9.71861 9.20235 9.71861H8.81432V12.7685C8.81432 12.8684 8.77676 12.9183 8.70166 12.9183H7.61266ZM8.81432 8.42511H9.15228C9.49442 8.42511 9.74059 8.29803 9.8908 8.04387C10.0494 7.78971 10.1286 7.40393 10.1286 6.88654C10.1286 6.31467 10.0494 5.9062 9.8908 5.66112C9.74059 5.41604 9.50277 5.2935 9.17732 5.2935H8.81432V8.42511Z"
        fill="currentColor"
      />
      <path
        d="M14.4331 13C13.6821 13 13.123 12.7549 12.7558 12.2648C12.397 11.7655 12.2176 11.0166 12.2176 10.0182V4.13616C12.2176 4.04539 12.2551 4 12.3302 4H13.4192C13.4943 4 13.5319 4.04539 13.5319 4.13616V9.97731C13.5319 10.5946 13.6028 11.0348 13.7447 11.298C13.8865 11.5613 14.116 11.6929 14.4331 11.6929C14.7586 11.6929 14.9922 11.5658 15.1341 11.3116C15.2759 11.0484 15.3469 10.6036 15.3469 9.97731V4.13616C15.3469 4.04539 15.3844 4 15.4595 4H16.5485C16.6236 4 16.6612 4.04539 16.6612 4.13616V10.0182C16.6612 11.0166 16.4734 11.7655 16.0979 12.2648C15.7307 12.7549 15.1758 13 14.4331 13Z"
        fill="currentColor"
      />
      <path
        d="M18.8839 12.9183C18.8088 12.9183 18.7712 12.8684 18.7712 12.7685V5.2935H17.4694C17.386 5.2935 17.3443 5.24357 17.3443 5.14372V4.14977C17.3443 4.04992 17.386 4 17.4694 4H21.3873C21.4624 4 21.5 4.04992 21.5 4.14977V5.14372C21.5 5.24357 21.4624 5.2935 21.3873 5.2935H20.0855V12.7685C20.0855 12.8684 20.0438 12.9183 19.9604 12.9183H18.8839Z"
        fill="currentColor"
      />
    </svg>
  );
};

const DeleteIcon = ({ className }: { className?: string }) => {
  return (
    <svg
      width="24"
      height="16"
      viewBox="0 0 24 16"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={cn(`text-[#DB3B4B] dark:text-[#DB5C5C]`, className)}
    >
      <path
        d="M7.6442 13C7.54807 13 7.5 12.9496 7.5 12.8489V4.15114C7.5 4.05038 7.54807 4 7.6442 4H9.3353C10.2879 4 11.0002 4.30687 11.4721 4.92061C11.9528 5.53435 12.1931 6.47328 12.1931 7.7374V8.96031C12.1931 10.3252 11.9572 11.342 11.4852 12.0107C11.022 12.6702 10.3229 13 9.38774 13H7.6442ZM8.87647 11.6947H9.3353C9.86841 11.6947 10.2486 11.4794 10.4758 11.0489C10.7118 10.6092 10.8298 9.92672 10.8298 9.00153V7.7374C10.8298 6.90382 10.7074 6.29008 10.4627 5.89618C10.218 5.50229 9.82908 5.30534 9.29597 5.30534H8.87647V11.6947Z"
        fill="currentColor"
      />
      <path
        d="M13.2896 13C13.2022 13 13.1585 12.9496 13.1585 12.8489V4.15114C13.1585 4.05038 13.1978 4 13.2765 4H16.7636C16.8422 4 16.8815 4.05038 16.8815 4.15114V5.1542C16.8815 5.25496 16.8422 5.30534 16.7636 5.30534H14.535V7.80611H16.5669C16.6456 7.80611 16.6849 7.85649 16.6849 7.95725V8.90534C16.6849 9.00611 16.6456 9.05649 16.5669 9.05649H14.535V11.6947H16.7636C16.8422 11.6947 16.8815 11.745 16.8815 11.8458V12.8489C16.8815 12.9496 16.8422 13 16.7636 13H13.2896Z"
        fill="currentColor"
      />
      <path
        d="M18.0391 13C17.9518 13 17.9081 12.9496 17.9081 12.8489V4.15114C17.9081 4.05038 17.9518 4 18.0391 4H19.1534C19.2408 4 19.2845 4.05038 19.2845 4.15114V11.6947H21.3689C21.4563 11.6947 21.5 11.745 21.5 11.8458V12.8489C21.5 12.9496 21.4563 13 21.3689 13H18.0391Z"
        fill="currentColor"
      />
    </svg>
  );
};
